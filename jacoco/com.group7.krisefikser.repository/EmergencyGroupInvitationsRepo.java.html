<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>EmergencyGroupInvitationsRepo.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">krisefikser</a> &gt; <a href="index.source.html" class="el_package">com.group7.krisefikser.repository</a> &gt; <span class="el_source">EmergencyGroupInvitationsRepo.java</span></div><h1>EmergencyGroupInvitationsRepo.java</h1><pre class="source lang-java linenums">package com.group7.krisefikser.repository;

import com.group7.krisefikser.model.EmergencyGroupInvitation;
import java.util.List;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.dao.EmptyResultDataAccessException;
import org.springframework.jdbc.core.JdbcTemplate;
import org.springframework.stereotype.Repository;

/**
 * Repository class for managing emergency group invitations in the database.
 * This class provides methods to add and delete emergency group invitations.
 */
@Repository
public class EmergencyGroupInvitationsRepo {
  private final JdbcTemplate jdbcTemplate;

  /**
   * Constructor for EmergencyGroupInvitationsRepo.
   *
   * @param jdbcTemplate the JdbcTemplate to be used for database operations
   */
  @Autowired
<span class="fc" id="L24">  public EmergencyGroupInvitationsRepo(JdbcTemplate jdbcTemplate) {</span>
<span class="fc" id="L25">    this.jdbcTemplate = jdbcTemplate;</span>
<span class="fc" id="L26">  }</span>

  /**
   * Inserts a new emergency group invitation into the database.
   *
   * @param invitation the EmergencyGroupInvitation object to be inserted
   */
  public void addEmergencyGroupInvitation(EmergencyGroupInvitation invitation) {
<span class="fc" id="L34">    String sql = &quot;INSERT INTO emergency_group_invitations (household_id, &quot;</span>
        + &quot;emergency_group_id) VALUES (?, ?)&quot;;
<span class="fc" id="L36">    jdbcTemplate.update(sql, invitation.getHouseholdId(), invitation.getGroupId());</span>
<span class="fc" id="L37">  }</span>

  /**
   * Deletes an emergency group invitation from the database.
   *
   * @param householdId the ID of the user whose invitation is to be deleted
   * @param groupId     the ID of the emergency group
   */
  public int deleteEmergencyGroupInvitation(long householdId, long groupId) {
<span class="fc" id="L46">    String sql = &quot;DELETE FROM emergency_group_invitations WHERE household_id &quot;</span>
        + &quot;= ? AND emergency_group_id = ?&quot;;
<span class="fc" id="L48">    return jdbcTemplate.update(sql, householdId, groupId);</span>
  }

  /**
   * Checks if an emergency group invitation exists in the database.
   *
   * @param householdId the ID of the user to check
   * @param groupId     the ID of the emergency group
   * @return true if the invitation exists, false otherwise
   */
  public boolean isInvitedToGroup(long householdId, long groupId) {
<span class="fc" id="L59">    String sql = &quot;SELECT COUNT(*) FROM emergency_group_invitations &quot;</span>
            + &quot;WHERE household_id = ? AND emergency_group_id = ?&quot;;

    try {
<span class="fc" id="L63">      Integer count = jdbcTemplate.queryForObject(sql, Integer.class, householdId, groupId);</span>
<span class="pc bpc" id="L64" title="1 of 4 branches missed.">      return count != null &amp;&amp; count &gt; 0;</span>
<span class="nc" id="L65">    } catch (EmptyResultDataAccessException e) {</span>
<span class="nc" id="L66">      return false;</span>
    }

  }

  /**
   * Retrieves all emergency group invitations for a specific household.
   *
   * @param householdId the ID of the household
   * @return a list of emergency group invitations
   */
  public List&lt;EmergencyGroupInvitation&gt; getInvitationsByHouseholdId(long householdId) {
<span class="fc" id="L78">    String sql = &quot;SELECT * FROM emergency_group_invitations WHERE household_id = ?&quot;;</span>
<span class="fc" id="L79">    return jdbcTemplate.query(sql, (rs, rowNum) -&gt; {</span>
<span class="fc" id="L80">      EmergencyGroupInvitation invitation = new EmergencyGroupInvitation();</span>
<span class="fc" id="L81">      invitation.setId(rs.getLong(&quot;id&quot;));</span>
<span class="fc" id="L82">      invitation.setHouseholdId(rs.getLong(&quot;household_id&quot;));</span>
<span class="fc" id="L83">      invitation.setGroupId(rs.getLong(&quot;emergency_group_id&quot;));</span>
<span class="fc" id="L84">      invitation.setCreatedAt(rs.getTimestamp(&quot;created_at&quot;).toLocalDateTime());</span>
<span class="fc" id="L85">      return invitation;</span>
<span class="fc" id="L86">    }, householdId);</span>
  }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.13.202504020838</span></div></body></html>